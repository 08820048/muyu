<!DOCTYPE html>
<html lang="zh" data-theme="light" dir="ltr">
  <head>
    <title>è¯¦è§£è®¾è®¡æ¨¡å¼_å•ä¾‹çš„è¿›åŒ–ä¹‹è·¯ - å…«å°ºå¦–å‰‘</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="æ·±å…¥è§£æå•ä¾‹æ¨¡å¼çš„å„ç§å®ç°æ–¹å¼ï¼Œä»é¥¿æ±‰å¼åˆ°æ‡’æ±‰å¼ï¼Œä»çº¿ç¨‹å®‰å…¨åˆ°é˜²åå°„ç ´åï¼Œè¯¦ç»†ä»‹ç»å•ä¾‹æ¨¡å¼çš„è¿›åŒ–å†ç¨‹å’Œæœ€ä½³å®è·µã€‚"/>

    <meta property="og:title" content="å…«å°ºå¦–å‰‘ -&nbsp;è¯¦è§£è®¾è®¡æ¨¡å¼_å•ä¾‹çš„è¿›åŒ–ä¹‹è·¯" />
    <meta property="og:type" content="website"/><meta property="og:url" content="https:&#x2F;&#x2F;ilikexff.cn&#x2F;xiang-jie-she-ji-mo-shi-dan-li-de-jin-hua-zhi-lu&#x2F;"/><meta property="og:description" content="æ·±å…¥è§£æå•ä¾‹æ¨¡å¼çš„å„ç§å®ç°æ–¹å¼ï¼Œä»é¥¿æ±‰å¼åˆ°æ‡’æ±‰å¼ï¼Œä»çº¿ç¨‹å®‰å…¨åˆ°é˜²åå°„ç ´åï¼Œè¯¦ç»†ä»‹ç»å•ä¾‹æ¨¡å¼çš„è¿›åŒ–å†ç¨‹å’Œæœ€ä½³å®è·µã€‚"/>


    <meta name="twitter:card" content="summary">


    <link rel="stylesheet" href="https://ilikexff.cn/spectre/spectre.css">
    <link rel="stylesheet" href="https://ilikexff.cn/theme.css"><link rel="stylesheet" href="https://ilikexff.cn/custom.css">
    
<link rel="shortcut icon" href="https://ilikexff.cn/./assets/bachiico.ico" type="image/x-icon" /><link rel="alternate" type="application/rss+xml" title="å…«å°ºå¦–å‰‘ RSS" href="https://ilikexff.cn/rss.xml">
        
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script>
        function doRenderMath() {
            renderMathInElement(document.body, {
                delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\(", right: "\\)", display: false},
                {left: "\\begin{equation}", right: "\\end{equation}", display: true},
                {left: "\\begin{align}", right: "\\end{align}", display: true},
                {left: "\\begin{alignat}", right: "\\end{alignat}", display: true},
                {left: "\\begin{gather}", right: "\\end{gather}", display: true},
                {left: "\\begin{CD}", right: "\\end{CD}", display: true},
                {left: "\\[", right: "\\]", display: true}
                ]
            });
        }
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
        onload="doRenderMath()"></script>

      </head>
  <body id="top" class="sticky-footer"><div id="page-wrapper">
<header id="header" class="section">
  <section class="container grid-xl">
    <nav class="navbar">
      <section class="navbar-section">
        
<a class="site-logo" href="https:&#x2F;&#x2F;ilikexff.cn">
  
  <div class="col-mx-auto">
    <figure style="margin: 8px">
      <img class="img-responsive"
           style="max-height: 45px"
           alt="frontmatter image"
           src="https://ilikexff.cn/./assets/logo.png">
    </figure>
  </div>
  
</a>

      </section><!-- ./home button -->

      <section class="navbar-center hide-md"></section>

      <section class="navbar-section">
        <nav class="dropmenu animated hide-md">

<ul><li>
        <a href="https://ilikexff.cn/tags">æ ‡ç­¾</a>
    </li><li>
        <a href="https://ilikexff.cn/categories">åˆ†ç±»</a>
    </li><li>
        <a href="https://ilikexff.cn/about">å…³äº</a>
    </li></ul>


          </nav>
      </section><!-- ./desktop-menu -->
    </nav>
  </section><!-- ./container -->
</header>


<div class="mobile-menu">
  <div class="button_container" id="toggle" onclick="openOverlay()">
    <span class="top"></span>
    <span class="middle"></span>
    <span class="bottom"></span>
  </div>
</div><!--./mobile-menu-->


<section id="start"><section id="body-wrapper" class="section">
          <section class="container grid-xl">
<div id="breadcrumbs" itemtype="http://schema.org/BreadcrumbList" class="hide-sm">
  
    
    <span><a href="https:&#x2F;&#x2F;ilikexff.cn&#x2F;">Home</a></span>
  
    <span><a href="https:&#x2F;&#x2F;ilikexff.cn&#x2F;xiang-jie-she-ji-mo-shi-dan-li-de-jin-hua-zhi-lu&#x2F;">è¯¦è§£è®¾è®¡æ¨¡å¼_å•ä¾‹çš„è¿›åŒ–ä¹‹è·¯</a></span>
</div>
<div class="columns">
              <div id="item" class="column col-8 col-md-12 extra-spacing">
<div class="card">
  

    <div class="card-header">
      <div class="card-title" style="margin-top: .25rem;"><div>
          <h1 class="post-title">è¯¦è§£è®¾è®¡æ¨¡å¼_å•ä¾‹çš„è¿›åŒ–ä¹‹è·¯</h1>
          
    <div class="post-meta" style="display: inline-flex">
        <span class="blog-date" style="display: inline-flex;">
          <i class="gg-calendar" style="margin-right: 5px;"></i><time datetime="2023.01.31">
          2023.01.31
          </time></span><span class="post-author" style="margin-left: 5px; display: inline-flex;">
          - 
    å…«å°ºå¦–å‰‘
        </span></div>

        </div></div>
    </div><!--./card-header-->

    <div class="card-body">
      
        <h2 id="gai-nian">æ¦‚å¿µ<a class="zola-anchor" href="#gai-nian" aria-label="Anchor link for: gai-nian">ğŸ”—</a></h2>
<p><strong>å•ä¾‹æ¨¡å¼</strong>(<code>Singleton Pattern</code>)æ˜¯è®¾è®¡æ¨¡å¼ä¸­ä¸€ä¸ªé‡è¦çš„æ¨¡å¼ä¹‹ä¸€ï¼Œæ˜¯ç¡®ä¿ä¸€ä¸ªç±»åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ç»å¯¹<strong>åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚<strong>å•ä¾‹æ¨¡å¼ä¸€èˆ¬ä¼šå±</strong>è”½æ„é€ å™¨</strong>ï¼Œå•ä¾‹å¯¹è±¡æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ï¼Œå±äº<a class="" href="https://baike.baidu.com/item/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/22912595?fr=aladdin">åˆ›å»ºå‹æ¨¡å¼</a>ã€‚</p>
<p>æ ¹æ®åˆå§‹åŒ–æ—¶é—´çš„ä¸åŒï¼Œå¯ä»¥å°†å•ä¾‹æ¨¡å¼åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>é¥¿æ±‰å¼å•ä¾‹</li>
<li>æ‡’æ±‰å¼å•ä¾‹</li>
</ul>
<p>å½“ç„¶ï¼Œé™¤äº†ä¸Šé¢çš„ä¸¤ä¸ªåˆ†ç±»ä¹‹å¤–ï¼Œå¤„äºå¯¹æ€§èƒ½ã€å®‰å…¨ç­‰æ–¹é¢çš„è€ƒé‡ï¼Œå•ä¾‹æ¨¡å¼è¿˜æ¼”åŒ–å‡ºäº†å„ç§å®ç°ç‰ˆæœ¬ï¼Œæ¯ä¸€ç§ç‰ˆæœ¬çš„æ¼”è¿›ï¼Œéƒ½æ˜¯å•ä¾‹çš„ä¸€æ¬¡**è¿›åŒ–ä¸å‡çº§ï¼Œ**ä¸‹é¢å°±æ¥çœ‹çœ‹å•ä¾‹æ¨¡å¼çš„è¿›åŒ–ä¹‹è·¯ä¸Šéƒ½ç»å†äº†å“ªäº›æŒ‘æˆ˜ä¸å¯¹æŠ—ã€‚</p>
<hr />
<h2 id="e-yi-shi-dan-li">é¥¿æ±‰å¼å•ä¾‹<a class="zola-anchor" href="#e-yi-shi-dan-li" aria-label="Anchor link for: e-yi-shi-dan-li">ğŸ”—</a></h2>
<blockquote>
<p>é¥¿æ±‰å¼å•ä¾‹ï¼Œç‰¹æŒ‡åœ¨ <strong>ç±»åŠ è½½çš„æ—¶å€™å°±ç«‹å³åˆå§‹åŒ–å¹¶åˆ›å»ºå•ä¾‹å¯¹è±¡</strong>çš„ä¸€ç§å•ä¾‹æ¨¡å¼å†™æ³•ã€‚ç”±äºæ˜¯åœ¨<strong>çº¿ç¨‹è¿˜æ²¡æœ‰å‡ºç°ä¹‹å‰</strong>å°±è¢«å®ä¾‹åŒ–äº†ï¼Œæ‰€ä»¥è¿™ç§æ¨¡å¼ä¸‹çš„å•ä¾‹æ˜¯çº¿ç¨‹ç»å¯¹å®‰å…¨çš„ï¼Œä¸å­˜åœ¨è®¿é—®å®‰å…¨çš„é—®é¢˜ã€‚</p>
</blockquote>
<p>æ ¹æ®å…·ä½“çš„å®ç°æ–¹å¼åˆ’åˆ†ï¼Œé¥¿æ±‰å¼å•ä¾‹å¯ä»¥é€šè¿‡ <strong>ç§æœ‰åŒ–æ„é€ å™¨</strong>ä»¥åŠ <strong>ä½¿ç”¨é™æ€ä»£ç å—</strong>çš„æ–¹å¼å…·ä½“å®ç°ã€‚</p>
<ul>
<li>ç§æœ‰åŒ–æ„é€ å™¨å†™æ³•ï¼š<code>HungrySingleton.java</code></li>
</ul>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 9:32
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: é¥¿æ±‰å¼å•ä¾‹-æ„é€ å™¨ç§æœ‰åŒ–å†™æ³•
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">HungrySingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private static final </span><span style="color:#859900;">HungrySingleton </span><span>hungrSingleton  </span><span style="color:#657b83;">= </span><span style="color:#859900;">new HungrySingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">HungrySingleton</span><span style="color:#657b83;">() {}</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">HungrySingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">() {
</span><span>        </span><span style="color:#859900;">return</span><span> hungrSingleton;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†æ„é€ å™¨è¿›è¡Œäº†ç§æœ‰åŒ–ä¹‹åï¼Œæ— æ³•å†é€šè¿‡<code>new</code>æ¥åˆ›å»ºå¯¹è±¡ï¼Œè¿™ç§å®ç°ä¸‹ï¼Œåªèƒ½é€šè¿‡æä¾›çš„<code>getInstance()</code>æ–¹æ³•æ¥è·å¾—å•ä¾‹å¯¹è±¡ã€‚</p>
<ul>
<li>é™æ€ä»£ç å—å†™æ³•:<code>HungryStaticSingleton.java</code></li>
</ul>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">è®¾è®¡æ¨¡å¼.å•ä¾‹æ¨¡å¼.é¥¿æ±‰å¼å•ä¾‹</span><span>;
</span><span>
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2022/4/23 8:36
</span><span style="color:#586e75;"> * @description: é¥¿æ±‰å¼å•ä¾‹é™æ€å—å†™æ³•
</span><span style="color:#586e75;"> * @blog:www.waer.ltd
</span><span style="color:#586e75;"> */
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">({</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">})
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">HungryStaticSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private static final </span><span style="color:#859900;">HungryStaticSingleton </span><span>hungryStaticSingleton;
</span><span>
</span><span>
</span><span>    </span><span style="color:#93a1a1;">static </span><span style="color:#657b83;">{
</span><span>        hungryStaticSingleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">new HungryStaticSingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">HungryStaticSingleton</span><span style="color:#657b83;">(){
</span><span>
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">HungryStaticSingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">(){
</span><span>        </span><span style="color:#859900;">return</span><span> hungryStaticSingleton;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<ul>
<li>æµ‹è¯•ç±»</li>
</ul>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">ltd.waer.javabaseforio.PatternDesign</span><span>;
</span><span>
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">)
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 9:42
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: é¥¿æ±‰å¼å•ä¾‹æµ‹è¯•ç±»
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">HungrySingletonTest </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) {
</span><span>        </span><span style="color:#586e75;">//ç§æœ‰æ„é€ å™¨å†™æ³•
</span><span>        </span><span style="color:#859900;">HungrySingleton</span><span> hungrySingleton1 </span><span style="color:#657b83;">= </span><span style="color:#859900;">HungrySingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">HungrySingleton</span><span> hungrySingleton2 </span><span style="color:#657b83;">= </span><span style="color:#859900;">HungrySingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>hungrySingleton1 </span><span style="color:#657b83;">==</span><span> hungrySingleton2</span><span style="color:#657b83;">)</span><span>;
</span><span>
</span><span>        </span><span style="color:#586e75;">//é™æ€å—åˆå§‹åŒ–å†™æ³•
</span><span>        </span><span style="color:#859900;">HungryStaticSingleton</span><span> singleton3 </span><span style="color:#657b83;">= </span><span style="color:#859900;">HungryStaticSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">HungryStaticSingleton</span><span> singleton4 </span><span style="color:#657b83;">= </span><span style="color:#859900;">HungryStaticSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>singleton3</span><span style="color:#657b83;">==</span><span>singleton4</span><span style="color:#657b83;">)</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<blockquote>
<p>æµ‹è¯•ç»“æœ:trueã€‚è¯´æ˜ä¸¤ç§æ–¹å¼å®ç°çš„å•ä¾‹éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºä¸è®ºæˆ‘ä»¬è°ƒç”¨å¤šå°‘æ¬¡ <code>getInstance </code>æ–¹æ³•æœ€å<strong>è¿”å›çš„å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡</strong>ã€‚</p>
</blockquote>
<p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p>
<p>åˆ›å»ºçš„å¯¹è±¡æ²¡æœ‰æ·»åŠ ä»»ä½•é”ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ã€‚</p>
<p>ç”±äºæ˜¯åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥ä¸ç®¡æˆ‘ä»¬ä½¿ç”¨ä¸å¦ï¼Œå®ƒéƒ½å°†å æœ‰ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡é¡¹ç›®ä¸­å­˜åœ¨äº†å¤§é‡çš„å•ä¾‹ï¼Œé‚£ä¹ˆæ‰€å ç”¨çš„å†…å­˜é‡å°±<strong>å¾ˆå¯è§‚äº†</strong>ï¼Œç€å®æµªè´¹ã€‚</p>
<hr />
<h2 id="lan-yi-shi-dan-li">æ‡’æ±‰å¼å•ä¾‹<a class="zola-anchor" href="#lan-yi-shi-dan-li" aria-label="Anchor link for: lan-yi-shi-dan-li">ğŸ”—</a></h2>
<blockquote>
<p>é‚£ä¹ˆé’ˆå¯¹ä¸Šè¿°<strong>é¥¿æ±‰å¼å•ä¾‹</strong>å­˜åœ¨çš„ç©ºé—´å ç”¨é—®é¢˜ï¼Œæœ‰æ²¡æœ‰åˆé€‚çš„æ›¿æ¢æˆ–è€…è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿé‚£ä¹ˆæœ‰è¯·<strong>æ‡’æ±‰</strong>å‡ºåœºã€‚</p>
<p>è§åçŸ¥æ„ï¼Œ <strong>æ‡’æ±‰å¼å•ä¾‹</strong>ä¸<strong>é¥¿æ±‰å¼å•ä¾‹</strong>çš„ç†å¿µåˆšå¥½ç›¸åã€‚å®ƒä¸ä¼šåœ¨ <strong>ç±»åŠ è½½çš„æ—¶å€™å°±åˆå§‹åŒ–</strong>ï¼Œè€Œæ˜¯ç­‰åˆ°ç”¨åˆ°äº†æ‰ä¼šåˆå§‹åŒ–ï¼Œå°±è¿™ç‚¹æ¥è¯´ï¼Œç¡®å®å¾ˆ <strong>æ‡’æ±‰</strong>ï¼Œä¸é¥¿ä¸åƒé¥­(<del>ä¼¼ä¹æœ‰ç‚¹é“ç†??æˆ‘ä¸é¥¿çš„æ—¶å€™ä¹Ÿä¸æƒ³åƒé¥­</del>)ã€‚</p>
</blockquote>
<p>åˆ°è¿™é‡Œï¼Œå•ä¾‹æ¨¡å¼å°±å¼€å§‹è‡ªå·±çš„è¿›åŒ–ä¹‹è·¯äº†ï¼Œä¸‹é¢åˆ—ä¸€ä¸‹<strong>è¿›åŒ–è·¯çº¿</strong>ã€‚</p>
<p>è¿›åŒ–ä¸»çº¿ï¼š</p>
<blockquote>
<ul>
<li>æ™®é€šéçº¿ç¨‹å®‰å…¨å•ä¾‹
<ul>
<li>syncçº¿ç¨‹å®‰å…¨å•ä¾‹
<ul>
<li>åŒé‡æ£€æŸ¥é”å•ä¾‹
<ul>
<li>å†…éƒ¨ç±»å•ä¾‹
<ul>
<li>æšä¸¾å¼å•ä¾‹</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>æ‰“é‡å‰¯æœ¬:</p>
<blockquote>
<ul>
<li>å†…éƒ¨ç±»å•ä¾‹
<ul>
<li>æ³¨å†Œå¼å•ä¾‹</li>
<li>å•çº¿ç¨‹å®‰å…¨å•ä¾‹
<ul>
<li>æšä¸¾å¼å•ä¾‹</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="1-pu-tong-fei-xian-cheng-an-quan-dan-li">1. <strong>æ™®é€šéçº¿ç¨‹å®‰å…¨å•ä¾‹</strong><a class="zola-anchor" href="#1-pu-tong-fei-xian-cheng-an-quan-dan-li" aria-label="Anchor link for: 1-pu-tong-fei-xian-cheng-an-quan-dan-li">ğŸ”—</a></h3>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">ltd.waer.javabaseforio.PatternDesign.LazySingleton</span><span>;
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">)
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 9:47
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: ç‰ˆæœ¬ä¸€:éçº¿ç¨‹å®‰å…¨
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">LazySingleton </span><span style="color:#657b83;">{
</span><span>   </span><span style="color:#93a1a1;">private static </span><span style="color:#859900;">LazySingleton </span><span>lazySingleton </span><span style="color:#657b83;">= </span><span style="color:#b58900;">null</span><span>;
</span><span>
</span><span>   </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">LazySingleton</span><span style="color:#657b83;">() {
</span><span>
</span><span>   </span><span style="color:#657b83;">}</span><span>;
</span><span>
</span><span>   </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">LazySingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">() {
</span><span>       </span><span style="color:#859900;">if </span><span style="color:#657b83;">(</span><span style="color:#b58900;">null </span><span style="color:#657b83;">==</span><span> lazySingleton</span><span style="color:#657b83;">) {
</span><span>           lazySingleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">new LazySingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>       </span><span style="color:#657b83;">}
</span><span>       </span><span style="color:#859900;">return</span><span> lazySingleton;
</span><span>   </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) {
</span><span>        </span><span style="color:#859900;">LazySingleton</span><span> instance1 </span><span style="color:#657b83;">= </span><span style="color:#859900;">LazySingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">LazySingleton</span><span> instance2 </span><span style="color:#657b83;">= </span><span style="color:#859900;">LazySingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>instance1 </span><span style="color:#657b83;">==</span><span> instance2</span><span style="color:#657b83;">)</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>ä¸Šé¢æ˜¯å•ä¾‹çš„æœ€ç®€å•å†™æ³•ï¼Œä¹Ÿæ˜¯æœ€åˆçš„ä¸€ç§ç‰ˆæœ¬ï¼Œåœ¨å¼€å§‹æ—¶å°†å®ä¾‹èµ‹å€¼ä¸º<code>null</code>ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œæ˜¯åœ¨è°ƒç”¨<code>getInstance</code>æ–¹æ³•çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼Œè™½ç„¶å®ç°ç®€å•ï¼Œä½†ä¹Ÿå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œ<strong>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æœ‰ä¸€å®šå‡ ç‡ä¼šè¿”å›å¤šä¸ªå•ä¾‹å¯¹è±¡</strong>ï¼Œè¿™æ˜¾ç„¶è¿èƒŒäº†å•ä¾‹çš„åŸåˆ™ï¼Œè¿›ä¸€æ­¥çš„è§£å†³åŠæ³•å°±æ˜¯ä¸‹é¢è¿™ç§å®ç°ã€‚ä½¿ç”¨<code>synchronizeed</code>å…³é”®å­—ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
<h3 id="2-syncxian-cheng-an-quan-dan-li">2. <code>sync</code><strong>çº¿ç¨‹å®‰å…¨å•ä¾‹</strong><a class="zola-anchor" href="#2-syncxian-cheng-an-quan-dan-li" aria-label="Anchor link for: 2-syncxian-cheng-an-quan-dan-li">ğŸ”—</a></h3>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">ltd.waer.javabaseforio.PatternDesign.LazySingleton</span><span>;
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">)
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 9:51
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼å•ä¾‹-synchronized
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">LazySyncSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private static </span><span style="color:#859900;">LazySyncSingleton </span><span>lazySyncSingleton </span><span style="color:#657b83;">= </span><span style="color:#b58900;">null</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">LazySyncSingleton</span><span style="color:#657b83;">() {}</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public synchronized </span><span style="color:#859900;">LazySyncSingleton </span><span style="color:#b58900;">getInstance </span><span style="color:#657b83;">() {
</span><span>        </span><span style="color:#859900;">if </span><span style="color:#657b83;">(</span><span style="color:#b58900;">null </span><span style="color:#657b83;">==</span><span> lazySyncSingleton</span><span style="color:#657b83;">) {
</span><span>            lazySyncSingleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">new LazySyncSingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#657b83;">}
</span><span>        </span><span style="color:#859900;">return</span><span> lazySyncSingleton;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>ä¸Šé¢çš„å®ç°ä¹Ÿéå¸¸ç®€å•ï¼Œåœ¨å‰é¢ä¸€ç§å†™æ³•çš„åŸºç¡€å±±åŠ äº†ä¸€ä¸ª<code>synchronized</code>å…³é”®å­—å³å¯ï¼Œè¿™æ ·ç¡®å®è§£å†³äº†çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œä½†ä¹Ÿå¼•å‡ºäº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œ<strong>å‡å¦‚å•ä¾‹å¯¹è±¡çš„åˆ›å»ºéå¸¸å¤æ‚è€—æ—¶çš„æƒ…å†µä¸‹ï¼Œä¸€æ—¦å¹¶å‘é‡ä¸Šæ¥äº†ï¼ŒCPUå‹åŠ›ä¸Šå‡ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´å¤§æ‰¹é‡çº¿ç¨‹å‡ºç°é˜»å¡çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´ç¨‹åºçš„å…è®¸æ€§èƒ½å¤§å¹…ä¸‹é™</strong>ï¼Œè§£å†³æ–¹æ³•æ˜¯**åŒé‡æ£€æŸ¥é”(double-checked locking)**å•ä¾‹å†™æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<h3 id="3-shuang-zhong-jian-cha-suo-dan-li">3. <strong>åŒé‡æ£€æŸ¥é”å•ä¾‹</strong><a class="zola-anchor" href="#3-shuang-zhong-jian-cha-suo-dan-li" aria-label="Anchor link for: 3-shuang-zhong-jian-cha-suo-dan-li">ğŸ”—</a></h3>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">ltd.waer.javabaseforio.PatternDesign.LazySingleton</span><span>;
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">)
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 9:59
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: è§£å†³å†™æ³•2çš„é—®é¢˜ï¼ŒåŒé‡æ£€æŸ¥é”å†™æ³•
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">LazyDoubleCheckSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private volatile static </span><span style="color:#859900;">LazyDoubleCheckSingleton </span><span>lazyDoubleCheckSingleton </span><span style="color:#657b83;">= </span><span style="color:#b58900;">null</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">LazyDoubleCheckSingleton </span><span style="color:#657b83;">() {
</span><span>
</span><span>    </span><span style="color:#657b83;">}</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">LazyDoubleCheckSingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">() {
</span><span>        </span><span style="color:#859900;">if </span><span style="color:#657b83;">( </span><span style="color:#b58900;">null </span><span style="color:#657b83;">==</span><span> lazyDoubleCheckSingleton</span><span style="color:#657b83;">) {
</span><span>            </span><span style="color:#93a1a1;">synchronized </span><span style="color:#657b83;">(</span><span style="color:#859900;">LazyDoubleCheckSingleton</span><span>.</span><span style="color:#d33682;">class</span><span style="color:#657b83;">) {
</span><span>                </span><span style="color:#859900;">if </span><span style="color:#657b83;">(</span><span style="color:#b58900;">null </span><span style="color:#657b83;">==</span><span> lazyDoubleCheckSingleton</span><span style="color:#657b83;">) {
</span><span>                    lazyDoubleCheckSingleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">new LazyDoubleCheckSingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>                </span><span style="color:#657b83;">}
</span><span>            </span><span style="color:#657b83;">}
</span><span>        </span><span style="color:#657b83;">}
</span><span>        </span><span style="color:#859900;">return</span><span> lazyDoubleCheckSingleton;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>è¿™ç§å†™æ³•ä¸­ï¼Œè¾ƒäºä¸Šé¢çš„å†™æ³•åšäº†ä¸¤ä¸ªåœ°æ–¹çš„æ”¹å˜ã€‚</p>
<ul>
<li>
<p>åœ¨<code>lazyDoubleCheckSingleton</code>å±æ€§åŠ ä¸Šäº†<code>volatile</code>å…³é”®å­—ï¼ŒåŸå› å°±æ˜¯ä¸ºäº†è§£å†³<strong>å¤šçº¿ç¨‹ä¸‹å¯è§æ€§é—®é¢˜</strong>ï¼Œå› ä¸ºæˆ‘ä»¬çš„<code>getInstance</code>æ–¹æ³•åœ¨åˆ¤æ–­<code>lazyDoubleCheckSingleton</code>æ˜¯å¦ä¸º<code>null</code>æ—¶å¹¶æ²¡æœ‰åŠ é”ï¼Œæ‰€ä»¥å‡å¦‚çº¿ç¨‹<code>1</code>åˆå§‹åŒ–äº†å¯¹è±¡ï¼Œå¦å¤–çº¿ç¨‹<code>2</code>æ˜¯æ— æ³•æ„ŸçŸ¥çš„ï¼Œè€ŒåŠ ä¸Šäº†<code>volatile</code>ä¹‹åä¾¿å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
</li>
<li>
<p>æŠŠ<code>synchronized</code><strong>å…³é”®å­—ç§»åˆ°äº†æ–¹æ³•å†…éƒ¨ï¼Œå°½å¯èƒ½ç¼©å°åŠ é”çš„ä»£ç å—ï¼Œæå‡æ•ˆç‡</strong>ã€‚</p>
</li>
</ul>
<p>è¿­ä»£äº†è¿™å‡ ä¸ªç‰ˆæœ¬ï¼Œåˆ°è¿™é‡Œæ˜¯å¦å°±å·²ç»å®Œç¾äº†å‘¢ï¼Ÿå…¶å®ä¸æ˜¯ï¼Œè¿™ç§å†™æ³•ä¾æ—§å­˜åœ¨é—®é¢˜ï¼Œé‚£å°±æ˜¯<strong>æŒ‡ä»¤é‡æ’</strong>é—®é¢˜ã€‚</p>
<p>ä¸Šé¢<code>new</code>å¯¹è±¡åªæœ‰ä¸€è¡Œä»£ç ï¼Œç„¶è€Œè¿™è¡Œä»£ç åœ¨<code>JVM</code>åº•å±‚å´åˆ†æˆäº†3æ­¥ï¼š</p>
<ol>
<li>åˆ†é…å†…å­˜æ¥åˆ›å»ºå¯¹è±¡ï¼Œå³<code>new</code>æ“ä½œã€‚</li>
<li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡<code>lazyDoubleCheckSingleton</code>æ­¤æ—¶<code>lazyDoubleCheckSingleton==nul</code>ã€‚</li>
<li>å°†<code>new</code>å‡ºæ¥çš„å¯¹è±¡èµ‹ç»™<code>lazyDoubleCheckSingleton</code>ã€‚</li>
</ol>
<p>ä½†å®é™…è¿è¡Œçš„æ—¶å€™ä¸ºäº†æå‡æ•ˆç‡ï¼Œè¿™<code>3</code>æ­¥å¹¶<strong>ä¸ä¼šæŒ‰ç…§å®é™…é¡ºåº</strong>æ¥è¿è¡Œã€‚</p>
<blockquote>
<p>å‡å¦‚çº¿ç¨‹<code>t1</code>è¿›å…¥åŒæ­¥ä»£ç å—æ­£åœ¨åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ­¤æ—¶æ‰§è¡Œäº†åé¢<code>2</code>æ­¥ï¼Œä¹Ÿå³æ˜¯æ­¤æ—¶<code>lazyDoubleCheckSingleton</code>ä¾å·²ç»ä¸ä¸º<code>null</code>äº†ï¼Œä½†æ˜¯å¯¹è±¡å´æ²¡æœ‰åˆ›å»ºç»“æŸï¼Œè¿™æ—¶å€™åˆæ¥äº†ä¸€ä¸ªçº¿ç¨‹<code>t2</code>è¿›å…¥<code>getInstance</code>æ–¹æ³•ï¼Œè¿™æ—¶å€™<code>if</code>æ¡ä»¶ä¸å†æˆç«‹ï¼Œçº¿ç¨‹<code>t2</code>ä¼šç›´æ¥è¿”å›ä¸€ä¸ª<strong>æ®‹ç¼ºä¸å…¨çš„å¯¹è±¡</strong>ï¼Œè‡ªç„¶ä¼šå‡ºç°æŠ¥é”™ã€‚</p>
</blockquote>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢å¼•å‡ºäº†ç¬¬å››ä¸ªå•ä¾‹ç‰ˆæœ¬ï¼Œå³</p>
<h3 id="4-nei-bu-lei-dan-li">4. <strong>å†…éƒ¨ç±»å•ä¾‹</strong><a class="zola-anchor" href="#4-nei-bu-lei-dan-li" aria-label="Anchor link for: 4-nei-bu-lei-dan-li">ğŸ”—</a></h3>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">ltd.waer.javabaseforio.PatternDesign.LazySingleton</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">io</span><span>.</span><span style="color:#859900;">Serializable</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">lang</span><span>.</span><span style="color:#859900;">reflect</span><span>.</span><span style="color:#859900;">Constructor</span><span>;
</span><span>@</span><span style="color:#268bd2;">SuppressWarnings</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">all</span><span>&quot;</span><span style="color:#657b83;">)
</span><span style="color:#586e75;">/**
</span><span style="color:#586e75;"> * </span><span style="color:#859900;">@author</span><span style="color:#586e75;">: å…«å°ºå¦–å‰‘
</span><span style="color:#586e75;"> * @date: 2023/1/31 10:48
</span><span style="color:#586e75;"> * @email: ilikexff@gmail.com
</span><span style="color:#586e75;"> * @blog: https://www.waer.ltd
</span><span style="color:#586e75;"> * @Description: å†…éƒ¨ç±»æ‡’æ±‰å¼å•ä¾‹-è§£å†³æŒ‡ä»¤é‡æ’é—®é¢˜
</span><span style="color:#586e75;"> */
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">LazyInnerClassSingleton  </span><span style="color:#859900;">implements </span><span style="color:#268bd2;">Serializable </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">LazyInnerClassSingleton </span><span style="color:#657b83;">() {
</span><span>
</span><span>    </span><span style="color:#657b83;">}</span><span>;
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static final </span><span style="color:#859900;">LazyInnerClassSingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">() {
</span><span>        </span><span style="color:#859900;">return InnerLazy</span><span>.</span><span style="color:#cb4b16;">LAZY</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private static </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">InnerLazy </span><span style="color:#657b83;">{
</span><span>        </span><span style="color:#93a1a1;">private static final </span><span style="color:#859900;">LazyInnerClassSingleton </span><span style="color:#b58900;">LAZY </span><span style="color:#657b83;">=</span><span style="color:#859900;">new LazyInnerClassSingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>è¿™ç§å†™æ³•å·§å¦™çš„åˆ©ç”¨äº†<strong>å†…éƒ¨ç±»ä¼šç­‰åˆ°å¤–éƒ¨è°ƒç”¨æ—¶æ‰ä¼šè¢«åˆå§‹åŒ–çš„ç‰¹æ€§</strong>ï¼Œç”¨é¥¿æ±‰å¼å•ä¾‹çš„æ€æƒ³å®ç°äº†æ‡’æ±‰å¼å•ä¾‹ã€‚</p>
<p>è¿™ç§å†™æ³•çœ‹èµ·æ¥å·²ç»æ˜¯é«˜æ•ˆå®Œç¾ï¼Œä½†å…¶å®å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡<strong>åå°„</strong>çš„æ–¹å¼ç ´åè¿™ç§å†™æ³•ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#93a1a1;">public static</span><span> void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[]</span><span> args</span><span style="color:#657b83;">)</span><span> throws </span><span style="color:#859900;">Exception </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#859900;">Class</span><span>&lt;</span><span style="color:#859900;">?</span><span>&gt; clazz </span><span style="color:#657b83;">= </span><span style="color:#859900;">LazyInnerClassSingleton</span><span>.</span><span style="color:#d33682;">class</span><span>;
</span><span>    </span><span style="color:#859900;">Constructor</span><span> constructor </span><span style="color:#657b83;">=</span><span> clazz.</span><span style="color:#b58900;">getDeclaredConstructor</span><span style="color:#657b83;">()</span><span>;
</span><span>    constructor.</span><span style="color:#b58900;">setAccessible</span><span style="color:#657b83;">(</span><span style="color:#b58900;">true</span><span style="color:#657b83;">)</span><span>;
</span><span>    </span><span style="color:#859900;">Object</span><span> o1 </span><span style="color:#657b83;">=</span><span> constructor.</span><span style="color:#b58900;">newInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#859900;">Object</span><span> o2 </span><span style="color:#657b83;">= </span><span style="color:#859900;">LazyInnerClassSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>o1 </span><span style="color:#657b83;">==</span><span> o2</span><span style="color:#657b83;">)</span><span>; </span><span style="color:#586e75;">//false
</span><span style="color:#657b83;">}
</span></code></pre>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ„é€ æ–¹æ³•è¢«ç§æœ‰åŒ–äº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥<strong>åˆ©ç”¨åå°„æ¥ç ´åå•ä¾‹</strong>ã€‚ä¸ºäº†é˜²æ­¢åå°„ç ´åå•ä¾‹ï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„å†™æ³•å†æ”¹é€ ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="5-gai-jin-ban-de-nei-bu-lei-dan-li">5. æ”¹è¿›ç‰ˆçš„å†…éƒ¨ç±»å•ä¾‹<a class="zola-anchor" href="#5-gai-jin-ban-de-nei-bu-lei-dan-li" aria-label="Anchor link for: 5-gai-jin-ban-de-nei-bu-lei-dan-li">ğŸ”—</a></h3>
<p>``java
public class LazyInnerClassSingleton {</p>
<pre style="background-color:#002b36;color:#839496;"><code><span>private LazyInnerClassSingleton(){
</span><span>    //é˜²æ­¢åå°„ç ´åå•ä¾‹
</span><span>     if(null != InnerLazy.LAZY){
</span><span>       throw new RuntimeException(&quot;ä¸å…è®¸é€šè¿‡åå°„ç±»æ„é€ å•ä¾‹å¯¹è±¡&quot;);
</span><span>     }
</span><span>}
</span><span>
</span><span>public static final LazyInnerClassSingleton getInstance(){
</span><span>    return InnerLazy.LAZY;
</span><span>}
</span><span>
</span><span>private static class InnerLazy{
</span><span>    private static final LazyInnerClassSingleton LAZY = new LazyInnerClassSingleton();
</span><span>}
</span></code></pre>
<p>}</p>
<pre style="background-color:#002b36;color:#839496;"><code><span>
</span><span>å°½ç®¡å¦‚æ­¤ï¼Œä½†å‡å¦‚æˆ‘ä»¬çš„å•ä¾‹å¯¹è±¡å®ç°äº† `Serializable `æ¥å£ï¼Œé‚£ä¹ˆå†…éƒ¨ç±»çš„å†™æ³•å°±è¿˜æ˜¯èƒ½**é€šè¿‡åºåˆ—åŒ–æ¥ç ´å**ã€‚
</span><span>
</span><span>### 6. å®ç°äº†`Serializable`æ¥å£çš„å†…éƒ¨ç±»å•ä¾‹
</span><span>
</span><span>``java
</span><span>package singleton.lazy;
</span><span>
</span><span>import java.io.Serializable;
</span><span>
</span><span>public class LazyInnerClassSingleton implements Serializable {
</span><span>
</span><span>    private LazyInnerClassSingleton(){
</span><span>        //é˜²æ­¢åå°„ç ´åå•ä¾‹
</span><span>         if(null != InnerLazy.LAZY){
</span><span>           throw new RuntimeException(&quot;ä¸å…è®¸é€šè¿‡åå°„ç±»æ„é€ å•ä¾‹å¯¹è±¡&quot;);
</span><span>         }
</span><span>    }
</span><span>
</span><span>    public static final LazyInnerClassSingleton getInstance(){
</span><span>        return InnerLazy.LAZY;
</span><span>    }
</span><span>
</span><span>    private static class InnerLazy {
</span><span>        private static final LazyInnerClassSingleton LAZY = new LazyInnerClassSingleton();
</span><span>    }
</span><span>}
</span></code></pre>
<p>ç”±äºå®ç°äº†åºåˆ—åŒ–çš„æ¥å£ï¼Œæ‰€ä»¥å†…éƒ¨ç±»çš„å†™æ³•ä¾ç„¶å¯ä»¥é€šè¿‡åºåˆ—åŒ–æ¥è¿›è¡Œç ´åï¼Œæ¯”å¦‚ä½¿ç”¨ä¸‹é¢è¿™æ®µæµ‹è¯•ä»£ç ã€‚</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">singleton.lazy</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">io</span><span>.</span><span style="color:#859900;">FileInputStream</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">io</span><span>.</span><span style="color:#859900;">FileOutputStream</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">io</span><span>.</span><span style="color:#859900;">ObjectInputStream</span><span>;
</span><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">io</span><span>.</span><span style="color:#859900;">ObjectOutputStream</span><span>;
</span><span>
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">TestLazyInnerClassSingleton2 </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) {
</span><span>        </span><span style="color:#586e75;">//åºåˆ—åŒ–æ”»å‡»å†…éƒ¨ç±»å¼å•ä¾‹
</span><span>        </span><span style="color:#859900;">LazyInnerClassSingleton</span><span> s1 </span><span style="color:#657b83;">= </span><span style="color:#b58900;">null</span><span>;
</span><span>        </span><span style="color:#859900;">LazyInnerClassSingleton</span><span> s2 </span><span style="color:#657b83;">= </span><span style="color:#859900;">LazyInnerClassSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>
</span><span>        </span><span style="color:#859900;">FileOutputStream</span><span> fos </span><span style="color:#657b83;">= </span><span style="color:#b58900;">null</span><span>;
</span><span>
</span><span>        </span><span style="color:#859900;">try </span><span style="color:#657b83;">{
</span><span>            fos </span><span style="color:#657b83;">= </span><span style="color:#859900;">new FileOutputStream</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">LazyInnerClassSingleton.text</span><span>&quot;</span><span style="color:#657b83;">)</span><span>;
</span><span>            </span><span style="color:#859900;">ObjectOutputStream</span><span> oos </span><span style="color:#657b83;">= </span><span style="color:#859900;">new ObjectOutputStream</span><span style="color:#657b83;">(</span><span>fos</span><span style="color:#657b83;">)</span><span>;
</span><span>            oos.</span><span style="color:#b58900;">writeObject</span><span style="color:#657b83;">(</span><span>s2</span><span style="color:#657b83;">)</span><span>;
</span><span>            oos.</span><span style="color:#b58900;">flush</span><span style="color:#657b83;">()</span><span>;
</span><span>            oos.</span><span style="color:#b58900;">close</span><span style="color:#657b83;">()</span><span>;
</span><span>
</span><span>            </span><span style="color:#859900;">FileInputStream</span><span> fis </span><span style="color:#657b83;">= </span><span style="color:#859900;">new FileInputStream</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">LazyInnerClassSingleton.text</span><span>&quot;</span><span style="color:#657b83;">)</span><span>;
</span><span>            </span><span style="color:#859900;">ObjectInputStream</span><span> ois </span><span style="color:#657b83;">= </span><span style="color:#859900;">new ObjectInputStream</span><span style="color:#657b83;">(</span><span>fis</span><span style="color:#657b83;">)</span><span>;
</span><span>            s1 </span><span style="color:#657b83;">= (</span><span style="color:#859900;">LazyInnerClassSingleton</span><span style="color:#657b83;">)</span><span>ois.</span><span style="color:#b58900;">readObject</span><span style="color:#657b83;">()</span><span>;
</span><span>            ois.</span><span style="color:#b58900;">close</span><span style="color:#657b83;">()</span><span>;
</span><span>            </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>s1 </span><span style="color:#657b83;">==</span><span> s2</span><span style="color:#657b83;">)</span><span>;</span><span style="color:#586e75;">//è¾“å‡ºï¼šfalse
</span><span>        </span><span style="color:#657b83;">}</span><span style="color:#859900;">catch </span><span style="color:#657b83;">(</span><span style="color:#859900;">Exception </span><span style="color:#268bd2;">e</span><span style="color:#657b83;">){
</span><span>            e.</span><span style="color:#b58900;">printStackTrace</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#657b83;">}
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<blockquote>
<p>ä¸Šé¢ç¤ºä¾‹ä¸­ <code>s1</code> æ˜¯é€šè¿‡æˆ‘ä»¬è‡ªå·±æä¾›çš„å…¨å±€å…¥å£åˆ›å»ºçš„å¯¹è±¡ï¼Œè€Œ <code>s2</code> æ˜¯é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼åˆ›å»ºçš„å¯¹è±¡ï¼Œä¸ç›¸ç­‰è¯´æ˜è¿™æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´åºåˆ—åŒ–ç ´åäº†å•ä¾‹æ¨¡å¼ã€‚</p>
</blockquote>
<p>è§£å†³åŠæ³•å°±æ˜¯åœ¨ <code>LazyInnerClassSingleton</code> ç±»ä¸­åŠ ä¸€ä¸ª <code>readResolve</code> æ–¹æ³•ï¼Œé˜²æ­¢åºåˆ—åŒ–ç ´åå•ä¾‹ã€‚</p>
<h3 id="7-zai-gai-jin-ban-de-nei-bu-lei-dan-li">7. å†æ”¹è¿›ç‰ˆçš„å†…éƒ¨ç±»å•ä¾‹<a class="zola-anchor" href="#7-zai-gai-jin-ban-de-nei-bu-lei-dan-li" aria-label="Anchor link for: 7-zai-gai-jin-ban-de-nei-bu-lei-dan-li">ğŸ”—</a></h3>
<p>``java
package singleton.lazy;</p>
<p>import java.io.Serializable;</p>
<p>public class LazyInnerClassSingleton implements Serializable {</p>
<pre style="background-color:#002b36;color:#839496;"><code><span>private LazyInnerClassSingleton(){
</span><span>    //é˜²æ­¢åå°„ç ´åå•ä¾‹
</span><span>     if(null != InnerLazy.LAZY){
</span><span>       throw new RuntimeException(&quot;ä¸å…è®¸é€šè¿‡åå°„ç±»æ„é€ å•ä¾‹å¯¹è±¡&quot;);
</span><span>     }
</span><span>}
</span><span>
</span><span>public static final LazyInnerClassSingleton getInstance(){
</span><span>    return InnerLazy.LAZY;
</span><span>}
</span><span>
</span><span>private static class InnerLazy {
</span><span>    private static final LazyInnerClassSingleton LAZY = new LazyInnerClassSingleton();
</span><span>}
</span><span>
</span><span>//é˜²æ­¢é€šè¿‡åºåˆ—åŒ–ç ´åå•ä¾‹
</span><span>private Object readResolve(){
</span><span>    return InnerLazy.LAZY;
</span><span>}
</span></code></pre>
<p>}</p>
<pre style="background-color:#002b36;color:#839496;"><code><span>
</span><span>è¿™æ¬¡è¿”å›äº† `true`ï¼Œä¹Ÿå°±æ˜¯åºåˆ—åŒ–æ²¡æœ‰ç ´åå•ä¾‹äº†ã€‚åŸå› æ˜¯å› ä¸º `JDK `æºç ä¸­åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šæ£€éªŒä¸€ä¸ªç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ª `readResolve` æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šæ”¾å¼ƒé€šè¿‡åºåˆ—åŒ–äº§ç”Ÿçš„å¯¹è±¡ï¼Œè€Œè¿”å›åŸæœ¬çš„å¯¹è±¡ã€‚
</span><span>
</span><span>è¿™ç§æ–¹å¼è™½ç„¶ä¿è¯äº†å•ä¾‹ï¼Œä½†æ˜¯åœ¨æ ¡éªŒæ˜¯å¦å­˜åœ¨ `readResolve` æ–¹æ³•å‰è¿˜æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Œåªä¸è¿‡è¿™ä¸ªå¯¹è±¡ä¼šåœ¨å‘ç°ç±»ä¸­å­˜åœ¨ `readResolve` æ–¹æ³•åä¸¢æ‰ï¼Œç„¶åè¿”å›åŸæœ¬çš„å•ä¾‹å¯¹è±¡ã€‚è¿™ç§å†™æ³•åªæ˜¯ä¿è¯äº†ç»“æœçš„å”¯ä¸€ï¼Œä½†æ˜¯è¿‡ç¨‹ä¸­ä¾ç„¶ä¼š**è¢«å®ä¾‹åŒ–å¤šæ¬¡**ï¼Œå‡å¦‚åˆ›å»ºå¯¹è±¡çš„é¢‘ç‡å¢å¤§ï¼Œ**å°±æ„å‘³ç€å†…å­˜åˆ†é…çš„å¼€é”€ä¹Ÿéšä¹‹å¢å¤§ã€‚**
</span><span>
</span><span>**ä¸Šé¢ä»‹ç»äº†è¿™ä¹ˆå¤šç§å†™æ³•ï¼Œçœ‹èµ·æ¥æ¯ç§å†™æ³•ä¼¼ä¹éƒ½å­˜åœ¨é—®é¢˜ï¼Œéš¾é“å°±æ²¡æœ‰ä¸€ç§æœ€ä¼˜é›…ã€å®‰å…¨ã€é«˜æ•ˆçš„æ–¹æ³•å—ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬æœ€åè¦ä»‹ç»çš„æšä¸¾å¼å•ä¾‹ï¼Œä¸è¿‡åœ¨ä»‹ç»æšä¸¾å¼å•ä¾‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåˆ·ä¸€ä¸‹å‰¯æœ¬ï¼Œçœ‹çœ‹å…¶å®ƒå†™æ³•ã€‚**
</span><span>
</span><span>### 8. æ³¨å†Œå¼å•ä¾‹
</span><span>
</span><span>å°†æ¯ä¸€ä¸ªå®ä¾‹éƒ½ä¿å­˜èµ·æ¥ï¼Œç„¶ååœ¨éœ€è¦ä½¿ç”¨çš„æ—¶å€™ç›´æ¥é€šè¿‡å”¯ä¸€çš„æ ‡è¯†è·å–å®ä¾‹ï¼Œè¿™ä¾¿æ˜¯æ³¨å†Œå¼å•ä¾‹ã€‚
</span><span>
</span><span>```java
</span><span>import java.util.Map;
</span><span>import java.util.concurrent.ConcurrentHashMap;
</span><span>
</span><span>public class ContainerSingleton {
</span><span>    private ContainerSingleton(){
</span><span>
</span><span>    }
</span><span>
</span><span>    private static Map&lt;String,Object&gt; ioc = new ConcurrentHashMap&lt;&gt;();
</span><span>
</span><span>    public static Object getBean(String className){
</span><span>        synchronized (ioc){
</span><span>            //å¦‚æœå®¹å™¨ä¸­ä¸å­˜åœ¨å½“å‰å¯¹è±¡
</span><span>            if(!ioc.containsKey(className)){
</span><span>                Object obj = null;
</span><span>                try {
</span><span>                    obj = Class.forName(className).newInstance();
</span><span>                    //å°†classNameä½œä¸ºå”¯ä¸€æ ‡è¯†å­˜å…¥å®¹å™¨
</span><span>                    ioc.put(className,obj);
</span><span>                }catch (Exception e) {
</span><span>                    e.printStackTrace();
</span><span>                }
</span><span>                return obj;
</span><span>            }
</span><span>        }
</span><span>        //å¦‚æœå®¹å™¨ä¸­å·²ç»å­˜åœ¨äº†å•ä¾‹å¯¹è±¡ï¼Œåˆ™ç›´æ¥è¿”å›
</span><span>        return ioc.get(className);
</span><span>    }
</span><span>}
</span></code></pre>
<p>æ–°å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>MyObject.java</code>ï¼Œç”¨æ¥æµ‹è¯•å•ä¾‹ã€‚</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">singleton.register</span><span>;
</span><span>
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">MyObject </span><span style="color:#657b83;">{
</span><span style="color:#657b83;">}
</span></code></pre>
<p>æ–°å»ºä¸€ä¸ªæµ‹è¯•ç±» <code>TestContainerSingleton.java</code>ã€‚</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">singleton.register</span><span>;
</span><span>
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">TestContainerSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) {
</span><span>        </span><span style="color:#859900;">MyObject</span><span> myObject1 </span><span style="color:#657b83;">= (</span><span style="color:#859900;">MyObject</span><span style="color:#657b83;">) </span><span style="color:#859900;">ContainerSingleton</span><span>.</span><span style="color:#b58900;">getBean</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">singleton.register.MyObject</span><span>&quot;</span><span style="color:#657b83;">)</span><span>;
</span><span>        </span><span style="color:#859900;">MyObject</span><span> myObject2 </span><span style="color:#657b83;">= (</span><span style="color:#859900;">MyObject</span><span style="color:#657b83;">) </span><span style="color:#859900;">ContainerSingleton</span><span>.</span><span style="color:#b58900;">getBean</span><span style="color:#657b83;">(</span><span>&quot;</span><span style="color:#2aa198;">singleton.register.MyObject</span><span>&quot;</span><span style="color:#657b83;">)</span><span>;
</span><span>
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>myObject1 </span><span style="color:#657b83;">==</span><span> myObject2</span><span style="color:#657b83;">)</span><span>;</span><span style="color:#586e75;">//è¾“å‡ºï¼štrue
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>ä¸Šé¢è¿”å› <code>true</code> æ˜¯å› ä¸ºæˆ‘ä»¬åŠ äº† <code>synchronized</code> å…³é”®å­—ï¼Œå®é™…ä¸Š <code>Spring </code>æ¡†æ¶ä¸­ç”¨çš„å°±æ˜¯å®¹å™¨å¼å•ä¾‹ï¼Œé»˜è®¤æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p>
<h3 id="9-dan-xian-cheng-an-quan-dan-li">9. å•çº¿ç¨‹å®‰å…¨å•ä¾‹<a class="zola-anchor" href="#9-dan-xian-cheng-an-quan-dan-li" aria-label="Anchor link for: 9-dan-xian-cheng-an-quan-dan-li">ğŸ”—</a></h3>
<p>åŸºäº<code>ThreadLocal</code>å®ç°ï¼Œè¯¥å•ä¾‹ä¸èƒ½ä¿è¯å…¶åˆ›å»ºçš„å¯¹è±¡æ˜¯å…¨å±€å”¯ä¸€ï¼Œä½†æ˜¯èƒ½ä¿è¯åœ¨å•ä¸ªçº¿ç¨‹ä¸­æ˜¯å”¯ä¸€çš„ï¼Œåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹çº¿ç¨‹å¤©ç”Ÿå®‰å…¨ã€‚</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#cb4b16;">import </span><span style="color:#859900;">java</span><span>.</span><span style="color:#859900;">util</span><span>.</span><span style="color:#859900;">concurrent</span><span>.</span><span style="color:#859900;">ThreadFactory</span><span>;
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">ThreadLocalSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#b58900;">ThreadLocalSingleton</span><span style="color:#657b83;">(){
</span><span>
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">private static final </span><span style="color:#859900;">ThreadLocal</span><span>&lt;</span><span style="color:#859900;">ThreadLocalSingleton</span><span>&gt; singleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">new ThreadLocal</span><span>&lt;</span><span style="color:#859900;">ThreadLocalSingleton</span><span>&gt;</span><span style="color:#657b83;">(){
</span><span>        @</span><span style="color:#268bd2;">Override
</span><span>        </span><span style="color:#93a1a1;">protected </span><span style="color:#859900;">ThreadLocalSingleton </span><span style="color:#b58900;">initialValue</span><span style="color:#657b83;">() {
</span><span>            </span><span style="color:#859900;">return new ThreadLocalSingleton</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#657b83;">}
</span><span>    </span><span style="color:#657b83;">}</span><span>;
</span><span>    
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">ThreadLocalSingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">(){
</span><span>        </span><span style="color:#859900;">return</span><span> singleton.</span><span style="color:#b58900;">get</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>æµ‹è¯•ç±»:</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">TestThreadLocalSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) {
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span style="color:#859900;">ThreadLocalSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">())</span><span>;</span><span style="color:#586e75;">//ä¸»çº¿ç¨‹è¾“å‡º
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span style="color:#859900;">ThreadLocalSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">())</span><span>;</span><span style="color:#586e75;">//ä¸»çº¿ç¨‹è¾“å‡º
</span><span>
</span><span>        </span><span style="color:#859900;">Thread</span><span> t1 </span><span style="color:#657b83;">= </span><span style="color:#859900;">new Thread</span><span style="color:#657b83;">(()</span><span style="color:#268bd2;">-&gt;</span><span style="color:#657b83;">{
</span><span>           </span><span style="color:#859900;">ThreadLocalSingleton</span><span> singleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">ThreadLocalSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>            </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span style="color:#859900;">Thread</span><span>.</span><span style="color:#b58900;">currentThread</span><span style="color:#657b83;">()</span><span>.</span><span style="color:#b58900;">getName</span><span style="color:#657b83;">() + </span><span>&quot;</span><span style="color:#2aa198;">:</span><span>&quot; </span><span style="color:#657b83;">+</span><span> singleton</span><span style="color:#657b83;">)</span><span>;
</span><span>        </span><span style="color:#657b83;">})</span><span>;
</span><span>        t1.</span><span style="color:#b58900;">start</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p><img src="https://s2.loli.net/2022/04/23/MZraX8gnyDBl5cS.png" alt="image-20220423105451698" loading="lazy" decoding="async" /></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œ<code>main</code> çº¿ç¨‹è¾“å‡ºçš„å’Œ <code>t1</code> çº¿ç¨‹è¾“å‡ºçš„å¹¶ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ•…è€Œ <code>ThreadLocal</code> å¼ç¤ºä¾‹ä»…å¯¹å•çº¿ç¨‹æ˜¯å®‰å…¨çš„ã€‚</p>
<h3 id="">10. æšä¸¾å¼å•ä¾‹<a class="zola-anchor" href="#" aria-label="Anchor link for: ">ğŸ”—</a></h3>
<p>æšä¸¾å¼å•ä¾‹å……åˆ†åˆ©ç”¨äº†æšä¸¾ç±»çš„ç‰¹æ€§æ¥åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œ<strong>ç›®å‰æ¥è¯´è¿™æ˜¯æœ€ä¼˜é›…çš„ä¸€ç§å†™æ³•ã€‚</strong></p>
<p>ç…§ä¾‹æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡ <code>MyObject.java</code> æ¥æµ‹è¯•å•ä¾‹ã€‚</p>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">singleton.meiju</span><span>;
</span><span>
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">MyObject </span><span style="color:#657b83;">{
</span><span style="color:#657b83;">}
</span></code></pre>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">EnumSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#859900;">INSTANCE</span><span>;
</span><span>    </span><span style="color:#93a1a1;">private </span><span style="color:#859900;">MyObject </span><span>myObject;
</span><span>
</span><span>    </span><span style="color:#b58900;">EnumSingleton</span><span style="color:#657b83;">(){
</span><span>        </span><span style="color:#d33682;">this</span><span>.myObject </span><span style="color:#657b83;">= </span><span style="color:#859900;">new MyObject</span><span style="color:#657b83;">()</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public </span><span style="color:#859900;">Object </span><span style="color:#b58900;">getData</span><span style="color:#657b83;">() {
</span><span>        </span><span style="color:#859900;">return</span><span> myObject;
</span><span>    </span><span style="color:#657b83;">}
</span><span>
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#859900;">EnumSingleton </span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">(){
</span><span>        </span><span style="color:#859900;">return </span><span style="color:#cb4b16;">INSTANCE</span><span>;
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<ul>
<li>æ–°å»ºæµ‹è¯•ç±» <code>TestEnumSingleton.java</code> è¿›è¡Œæµ‹è¯•ã€‚</li>
</ul>
<pre data-lang="java" style="background-color:#002b36;color:#839496;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#859900;">package </span><span style="color:#b58900;">singleton.meiju</span><span>;
</span><span>
</span><span style="color:#93a1a1;">public </span><span style="color:#268bd2;">class </span><span style="color:#b58900;">TestEnumSingleton </span><span style="color:#657b83;">{
</span><span>    </span><span style="color:#93a1a1;">public static </span><span style="color:#268bd2;">void </span><span style="color:#b58900;">main</span><span style="color:#657b83;">(</span><span style="color:#859900;">String</span><span style="color:#93a1a1;">[] </span><span style="color:#268bd2;">args</span><span style="color:#657b83;">) </span><span style="color:#859900;">throws Exception</span><span style="color:#657b83;">{
</span><span>        </span><span style="color:#859900;">EnumSingleton</span><span> enumSingleton </span><span style="color:#657b83;">= </span><span style="color:#859900;">EnumSingleton</span><span>.</span><span style="color:#b58900;">getInstance</span><span style="color:#657b83;">()</span><span>;
</span><span>        </span><span style="color:#859900;">System</span><span>.out.</span><span style="color:#b58900;">println</span><span style="color:#657b83;">(</span><span>enumSingleton.</span><span style="color:#b58900;">getData</span><span style="color:#657b83;">() ==</span><span> enumSingleton.</span><span style="color:#b58900;">getData</span><span style="color:#657b83;">())</span><span>;</span><span style="color:#586e75;">//è¾“å‡ºï¼štrue
</span><span>    </span><span style="color:#657b83;">}
</span><span style="color:#657b83;">}
</span></code></pre>
<p>è¾“å‡ºç»“æœä¸º <code>true</code>ï¼Œæšä¸¾å¼å•ä¾‹å†™æ³•èƒ½æœ‰æ•ˆçš„é˜²æ­¢é€šè¿‡åå°„ä»¥åŠåºåˆ—åŒ–æ‰‹æ®µçš„ç ´åï¼Œç¡®å®ä¸ºç›®å‰æœ€ä½³çš„å•ä¾‹å®è·µä¹‹é€‰ã€‚</p>
<hr />
<h2 id="-1">å°ç»“<a class="zola-anchor" href="#-1" aria-label="Anchor link for: -1">ğŸ”—</a></h2>
<p>å°½ç®¡å®ç°å•ä¾‹æ¨¡å¼çš„å…·ä½“æ€æƒ³å’Œæ–¹æ³•å¤šç§å¤šæ ·ï¼Œä¹Ÿå„æœ‰åƒç§‹å’Œä¸è¶³ï¼Œä½†åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œå¹¶ä¸æ˜¯æœ€ä¼˜çš„å°±æ˜¯æœ€åˆé€‚çš„ï¼Œåœ¨ä½¿ç”¨å•ä¾‹æ¨¡å¼æ—¶ï¼Œåº”è¯¥ç»“åˆå…·ä½“çš„é¡¹ç›®éœ€æ±‚ä»¥åŠåœºæ™¯æ¥é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼ã€‚æ¯”å¦‚å°é¡¹ç›®è¿½æ±‚çº¿ç¨‹å®‰å…¨åˆæ‹¥æœ‰è¶³å¤Ÿç©ºé—´çš„æƒ…å†µä¸‹ä½¿ç”¨<strong>é¥¿æ±‰å¼å•ä¾‹</strong>åˆä½•å°ä¸å¯ï¼Ÿ</p>
<hr />
<p>è‡´è°¢&amp;å¼•ç”¨:</p>
<ul>
<li><a class="" href="https://dzone.com/articles/java-singletons-using-enum">Java Singletons Using Enum</a></li>
<li><a class="" href="https://www.geeksforgeeks.org/advantages-and-disadvantages-of-using-enum-as-singleton-in-java/">Advantages and Disadvantages of using Enum as Singleton in Java</a></li>
<li><a class="" href="https://baike.baidu.com/item/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/22912595?fr=aladdin">ç™¾åº¦ç™¾ç§‘</a></li>
</ul>

      
    </div><!--./card-body-->

    <div class="card-footer">
      <div class="columns">
        <div class="column col-9 col-sm-7">
          <div class="taxonomies text-left">
            

    
          </div>
        </div><!--./col-6-->
        
        </div><!--./columns-->
    </div><!--./card-footer-->
</div><!--./card-->
</div>
              <div id="sidebar" class="column col-4 col-md-12">
                <div class="sidebar-content">
                  
                  
<div class="sidebar-widget">
  <div class="tile">
    <div class="tile-icon">
      <figure class="avatar avatar-xl">
        <img src="https://ilikexff.cn/avatar.png" alt="author avatar image">
      </figure>
    </div>
    <div class="tile-content">
      <p class="tile-title" style="font-weight: 600;">å…«å°ºå¦–å‰‘</p>
      <p class="tile-subtitle">çƒ­çˆ±ç¼–ç¨‹ï¼Œä¸“æ³¨äºæŠ€æœ¯åˆ†äº«å’Œå­¦ä¹ </p>
    </div>
</div><!--./tile-->
</div>

                  
                  
<div class="sidebar-widget">
  æ¬¢è¿æ¥åˆ°<strong>å…«å°ºå¦–å‰‘</strong>ï¼è¿™é‡Œåˆ†äº«æŠ€æœ¯æ–‡ç« å’Œç¼–ç¨‹å¿ƒå¾—ã€‚
</div><!-- end text widget -->

                  

                  
<div class="sidebar-widget syndicate">
<h4>Feed</h4>
<a class="btn" href="/rss.xml">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-rss-fill" viewBox="0 0 16 16">
  <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm1.5 2.5c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1 0-2zm0 4a6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1 0-2zm.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
</svg>
<span>RSS</span>
</a>
</div>

                  </div><!--./sidebar-content-->
              </div>
            </div>
            
          </section>
        </section></section>
<section class="container grid-xl">
<ul class="pagination paginator">
  
  
</ul>
</section>
</div><!-- ./page-wrapper -->

    
<div class="mobile-container">
        <div class="overlay" id="overlay">
            <div style="padding: 1rem;">
              
<a class="site-logo" href="https:&#x2F;&#x2F;ilikexff.cn">
  
  <div class="col-mx-auto">
    <figure style="margin: 8px">
      <img class="img-responsive"
           style="max-height: 45px"
           alt="frontmatter image"
           src="https://ilikexff.cn/./assets/logo.png">
    </figure>
  </div>
  
</a>

            </div>
            <nav class="overlay-menu">
              

<ul class="tree treemenu treemenu-root"><li class="tree-empty">
      <span class="toggler"></span>
      <a href="https://ilikexff.cn/tags">æ ‡ç­¾</a>
    </li><li class="tree-empty">
      <span class="toggler"></span>
      <a href="https://ilikexff.cn/categories">åˆ†ç±»</a>
    </li><li class="tree-empty">
      <span class="toggler"></span>
      <a href="https://ilikexff.cn/about">å…³äº</a>
    </li></ul>


              </nav>
        </div>
    </div>

<script type="text/javascript">
  var overlay = document.getElementById('overlay');
  var toggle = document.getElementById('toggle');

  function openOverlay(){
      // Open overlay
      if (overlay.classList.contains("open")) {
          overlay.classList.remove("open");
      }
      else {
          overlay.classList.add("open");
      }

      // Button transition
      if (toggle.classList.contains("active")) {
          toggle.classList.remove("active");
      }
      else {
          toggle.classList.add("active");
      }
    }
</script>

<section id="footer" class="bg-gray">
  <div class="container grid-xl">
    


    <div class="columns">
      
      <div class="column col-6 col-lg-12 col-mx-auto" style="text-align: center;">
        ç®€å•æ˜¯æ•ˆç‡çš„çµé­‚ | é»”ICPå¤‡2021010295å·
      </div>
      
      <div class="column col-6 col-lg-12 col-mx-auto" style="text-align: center;">
        Made by <a href="https://github.com/gicrisf/">gicrisf</a> -
        <strong>Zhuia</strong>&nbsp;<a href="https://github.com/gicrisf/zhuia">source code</a>
        is licensed under <a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT</a>.
      </div>
    </div>
  </div>
</section>
</body>
</html>
